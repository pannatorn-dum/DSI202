{% extends 'base2.html' %}
{% load static %}

{% block title %}Treevaq - Eco Products{% endblock %}

{% block extra_css %}
<style>
    /* ‡πÉ‡∏™‡πà CSS ‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á homepage ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà (‡∏¢‡∏Å‡∏°‡∏≤‡∏à‡∏≤‡∏Å‡πÄ‡∏î‡∏¥‡∏°) */
    body {
        background-color: #f1f9f1;
        transition: background-color 0.3s, color 0.3s;
    }
    body.dark {
        background-color: #121212;
        color: #f0f0f0;
    }
    .banner {
        background-color: #c8e6c9;
        padding: 20px;
        text-align: center;
        font-weight: bold;
        font-size: 20px;
    }
    .categories, .featured {
        display: flex;
        justify-content: center;
        gap: 20px;
        margin: 30px 20px;
        flex-wrap: wrap;
    }
    .category, .product {
        background-color: #e8f5e9;
        padding: 20px;
        width: 200px;
        border-radius: 16px;
        text-align: center;
        color: #333;
        font-weight: 600;
        transition: transform 0.2s;
        flex-shrink: 0;
    }
    .product:hover {
        transform: translateY(-5px);
        background-color: #dcedc8;
    }
    .product img {
        width: 100%;
        height: 160px;
        object-fit: cover;
        border-radius: 12px;
        margin-bottom: 10px;
    }
    h2 {
        text-align: center;
        color: #2e7d32;
    }
    body.dark .banner,
    body.dark .category,
    body.dark .product {
        background-color: #333 !important;
        color: #fff !important;
    }
    /* Carousel */
    .carousel-wrapper {
        position: relative;
        margin: 0 40px;
    }
    .carousel {
        display: flex;
        overflow-x: auto;
        scroll-behavior: smooth;
        gap: 20px;
        padding: 10px 0;
    }
    .carousel::-webkit-scrollbar {
        display: none;
    }
    .carousel-button {
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        background-color: #2e7d32;
        color: white;
        border: none;
        padding: 12px 16px;
        font-size: 24px;
        cursor: pointer;
        border-radius: 50%;
        z-index: 10;
        box-shadow: 0 2px 6px rgba(0,0,0,0.3);
        user-select: none;
        transition: background-color 0.3s;
    }
    .carousel-button:hover {
        background-color: #1b5e20;
    }
    .carousel-button.left {
        left: 0;
    }
    .carousel-button.right {
        right: 0;
    }
</style>
{% endblock %}

{% block navbar %}
<!-- ‡∏ñ‡πâ‡∏≤ base2.html ‡∏°‡∏µ navbar block ‡πÉ‡∏´‡πâ‡πÉ‡∏™‡πà navbar ‡πÅ‡∏ö‡∏ö‡πÄ‡∏î‡∏¥‡∏°‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà (‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ ‡∏Å‡πá‡∏•‡∏ö‡πÑ‡∏î‡πâ) -->
<div style="display: flex; align-items: center; gap: 15px;">
    <a href="{% url 'homepage' %}" style="color:white; text-decoration: none; font-weight: bold;">üå± Treevaq</a>
</div>
<div style="flex: 1; display: flex; align-items: center; gap: 15px; flex-wrap: wrap; justify-content: center;">
    <a href="#" data-key="all">All</a>
    <a href="#" data-key="best">Best Sellers</a>
    <a href="#" data-key="promo">Eco Promotions</a>
    <a href="#" data-key="sell">Sell</a>
    <form method="get" action="{% url 'homepage' %}" style="margin: 0; position: relative;">
        <input type="text" id="searchInput" name="q" placeholder="Search..." value="{{ request.GET.q }}"
               style="width: 250px; padding: 8px; border-radius: 8px; border: none;">
        <ul id="searchResults" style="display:none; position: absolute; top: 40px; left: 0; width: 100%; max-height: 200px; overflow-y: auto; background: white; border: 1px solid #ccc; border-radius: 8px; padding: 0; margin: 0; list-style: none; z-index: 1000;">
            {% if products %}
                {% for product in products %}
                <li style="padding: 8px; border-bottom: 1px solid #eee;">
                    <a href="{% url 'product_detail' product.id %}" style="text-decoration: none; color: black;">
                        {{ product.name }}
                    </a>
                </li>
                {% endfor %}
            {% endif %}
        </ul>
    </form>
</div>
<div style="display: flex; align-items: center; gap: 10px;">
    <select id="languageSelect" class="language-select">
        <option value="en">EN</option>
        <option value="th">TH</option>
    </select>
    <button id="toggleDark" class="toggle-dark">üåô</button>
    <a href="{% url 'login' %}" style="color: white; font-size: 20px;">üë§</a>
    <a href="{% url 'homepage' %}" style="color: white; font-size: 20px;">üõí</a>
</div>
{% endblock %}

{% block content %}
<div class="banner" id="bannerText">
    üåø Special Discount on Eco-friendly Products! üåç
</div>

<h2 data-key="promo" style="text-align: center; margin-top: 40px;">‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô‡∏£‡∏±‡∏Å‡∏©‡πå‡πÇ‡∏•‡∏Å üåø</h2>
<div class="carousel-wrapper">
    <button class="carousel-button left" onclick="scrollCarousel('promo-carousel', -1)">‚Äπ</button>
    <div id="promo-carousel" class="carousel featured">
        {% if promotions %}
            {% for product in promotions %}
                <a href="{% url 'product_detail' product.id %}" class="product" style="background-color:#d0f0c0; position: relative;">
                    {% if product.image %}
                        <img src="{{ product.image.url }}" alt="{{ product.name }}">
                    {% endif %}
                    {% if product.discount_percent > 0 %}
                        <div style="position: absolute; top: 10px; left: 10px; background-color: red; color: white; padding: 5px 8px; border-radius: 6px; font-size: 12px;">
                            ‡∏•‡∏î {{ product.discount_percent }}%
                        </div>
                    {% endif %}
                    <div>{{ product.name }}</div>
                </a>
            {% endfor %}
        {% else %}
            <p style="text-align: center; width: 100%;">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô‡∏£‡∏±‡∏Å‡∏©‡πå‡πÇ‡∏•‡∏Å</p>
        {% endif %}
    </div>
    <button class="carousel-button right" onclick="scrollCarousel('promo-carousel', 1)">‚Ä∫</button>
</div>

<h2 data-key="featured">Featured Eco-Friendly Products</h2>
<div class="carousel-wrapper">
    <button class="carousel-button left" onclick="scrollCarousel('featured-carousel', -1)">‚Äπ</button>
    <div id="featured-carousel" class="carousel featured">
        {% if products %}
            {% for product in products %}
                <a href="{% url 'product_detail' product.id %}" class="product">
                    {% if product.image %}
                        <img src="{{ product.image.url }}" alt="{{ product.name }}">
                    {% endif %}
                    <div>{{ product.name }}</div>
                </a>
            {% endfor %}
        {% else %}
            <p style="text-align: center; width: 100%;">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</p>
        {% endif %}
    </div>
    <button class="carousel-button right" onclick="scrollCarousel('featured-carousel', 1)">‚Ä∫</button>
</div>
{% endblock %}

{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', () => {
        const searchInput = document.getElementById('searchInput');
        const dropdown = document.getElementById('searchResults');

        function toggleDropdown() {
            if (searchInput.value.trim() === '') {
                dropdown.style.display = 'none';
            } else {
                dropdown.style.display = 'block';
            }
        }
        toggleDropdown();
        searchInput.addEventListener('input', toggleDropdown);
    });

    const translations = {
        en: {
            '‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô‡∏£‡∏±‡∏Å‡∏©‡πå‡πÇ‡∏•‡∏Å üåø': 'Eco Promotion üåø',
            '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô‡∏£‡∏±‡∏Å‡∏©‡πå‡πÇ‡∏•‡∏Å': 'No eco promotion products yet',
            '‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏£‡∏±‡∏Å‡∏©‡πå‡πÇ‡∏•‡∏Å': 'Featured Eco-Friendly Products',
            '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤': 'No products found',
        },
        th: {
            'Eco Promotion üåø': '‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô‡∏£‡∏±‡∏Å‡∏©‡πå‡πÇ‡∏•‡∏Å üåø',
            'No eco promotion products yet': '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô‡∏£‡∏±‡∏Å‡∏©‡πå‡πÇ‡∏•‡∏Å',
            'Featured Eco-Friendly Products': '‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏£‡∏±‡∏Å‡∏©‡πå‡πÇ‡∏•‡∏Å',
            'No products found': '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤',
        }
    };

    const languageSelect = document.getElementById('languageSelect');
    languageSelect.addEventListener('change', (e) => {
        const lang = e.target.value;
        document.querySelectorAll('[data-key]').forEach(el => {
            const key = el.getAttribute('data-key');
            if (key && translations[lang][el.textContent.trim()]) {
                el.textContent = translations[lang][el.textContent.trim()] || el.textContent;
            }
        });
    });

    const toggleDark = document.getElementById('toggleDark');
    toggleDark.addEventListener('click', () => {
        document.body.classList.toggle('dark');
        toggleDark.textContent = document.body.classList.contains('dark') ? '‚òÄÔ∏è' : 'üåô';
    });

    function scrollCarousel(id, direction) {
        const carousel = document.getElementById(id);
        if (!carousel) return;
        const card = carousel.querySelector('.product');
        if (!card) return;
        const scrollAmount = (card.offsetWidth + 20) * 3;
        carousel.scrollBy({ left: direction * scrollAmount, behavior: 'smooth' });
    }
</script>
{% endblock %}
